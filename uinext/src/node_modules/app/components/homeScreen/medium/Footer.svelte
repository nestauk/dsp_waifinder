<script>
	import Icon from '@svizzle/ui/src/icons/Icon.svelte';
	import Droplet from '@svizzle/ui/src/icons/feather/Droplet.svelte';
	import A11yPerson from '@svizzle/ui/src/icons/svizzle/A11yPerson.svelte';
	import Link from '@svizzle/ui/src/Link.svelte';

	import {isDev} from 'app/config';
	import {_currThemeVars, _showThemeEditor} from 'app/stores/theme';
	import theme from 'app/theme';

	export let isA11yDirty = false;
	export let segment;
	export let showA11yMenu = false;

	const toggleA11yMenu = event => {
		showA11yMenu = !showA11yMenu;
		event.target.setAttribute('aria-expanded', showA11yMenu.toString());
	}
	const toggleThemeEditor = () => {
		if (isDev) {
			$_showThemeEditor = !$_showThemeEditor;
		}
	}

	$: a11yFillColor = isA11yDirty ? $_currThemeVars['--color-main)'] : '';
	$: a11yStrokeColor = isA11yDirty
		? $_currThemeVars['--color-background-main']
		: $_currThemeVars['--color-main)'];
	$: makeColor = id => segment === id ? theme.colorLink : undefined;
</script>

<div class='Footer'>
	<span>
		<a href='https://www.ukri.org/'>
			<img src='/sponsors/UKResearchAndInnovation.svg' alt='Nesta' />
		</a>
		<a href='https://www.turing.ac.uk/'>
			<img src='/sponsors/AlanTuringInstitute.svg' alt='Nesta' />
		</a>
		<a href='https://www.nesta.org.uk/'>
			<img src='/sponsors/Nesta.svg' alt='Nesta' />
		</a>
	</span>
	<nav>
		<ul>
			<li
			class:selected='{segment === 'accessibility'}'
			role='none'
		>
			<Link
				href='accessibility'
				theme={{color: makeColor('accessibility')}}
			>
				Accessibility
			</Link>
		</li>
		<li role='none'>
			<button
				aria-label='Accessibility settings'
				on:click={toggleA11yMenu}
				class='clickable'
			>
				<Icon
					glyph={A11yPerson}
					stroke={a11yStrokeColor}
					strokeWidth=1
					fill={a11yFillColor}
				/>
			</button>
		</li>
		{#if isDev}
			<li role='none'>
				<button
					aria-label='Color theme'
					on:click={toggleThemeEditor}
					class='clickable'
				>
					<Icon
						glyph={Droplet}
						stroke={$_currThemeVars['--color-main)']}
						strokeWidth=1
					/>
				</button>
			</li>
		{/if}

		</ul>
	</nav>
</div>

<style>
	.Footer {
		display: grid;
		grid-auto-flow: column;
		align-items: center;
	}
	.Footer > span {
		justify-self: start;
	}
	.Footer > nav {
		justify-self: end;
	}
	.Footer img {
		height: 3em;
		padding: 0.5em 1em;
		vertical-align: middle;
	}
	ul {
		align-items: center;
		display: flex;
		flex-direction: row;
		margin: 0;
		padding: 0;
	}
	li {
		display: block;
		padding: 0 0.5em;
		white-space: nowrap;
	}
	li.selected {
		color: var(--color-link);
		display: inline-block;
		position: relative;
	}

	button {
		border: none;
		background: transparent;
		color: var(--color-main);
		width: min-content;
		height: min-content;
		z-index: var(--z-1000);
	}
</style>
