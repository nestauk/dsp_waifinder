<script>
	import { setContext } from "svelte";
	import { writable } from "svelte/store";

	export let currentViewId;
	const _currentViewId = writable(0);
	let views = [];

	const viewsContext = setContext("views", {
		_currentViewId,
		addView,
		renderAnyway: true
	});

	function addView (id) {
		views = [...views, id];
	}

	$: $_currentViewId = currentViewId;

	// FIXME: alphanumeric ids with mapping to position in array
</script>

<div class='viewport'>
	<div
		class='viewscontainer'
		style='--viewsCount: {views.length}; --currentViewId: {currentViewId}'
	>
		<slot />
	</div>
</div>

<style>
	.viewport {
		width: 100%;
		height: 100%;
	}
	.viewscontainer {
		width: calc( 100% * var(--viewsCount) );
		height: 100%;
		display: grid;
		grid-template-columns: calc( 100% / var(--viewsCount) );
		grid-auto-flow: column;
		transform: translateX(calc( var(--currentViewId) * -100%  / var(--viewsCount)));
	}
</style>
