<script>
	import {createEventDispatcher} from 'svelte';
	import {noop} from '@svizzle/utils';

	import {_isSmallScreen} from 'app/stores/layout';

	export let isVerticalLayout = false;

	let yesString;
	let noString;
	let skipString;

	const dispatch = createEventDispatcher();

	const voted = vote => {
		dispatch('voted', vote);
	};

	const keyboardVote = ({key}) => {
		if (key === 'y') {
			voted('keep')
		} else if (key === 'n') {
			voted('dismiss')
		} else if (key === 's') {
			voted('skip')
		}
	}

	$: handleKeydown = $_isSmallScreen ? noop : keyboardVote;
	$: if ($_isSmallScreen) {
		yesString = 'Yes';
		noString = 'No';
		skipString = 'Skip';
	} else {
		yesString = 'Yes [y]';
		noString = 'No [n]';
		skipString = 'Skip [s]';
	}
</script>

<svelte:window on:keydown={handleKeydown}/>

<div
	class:vertical={isVerticalLayout}
	class='controls'
>
	<button
		class='keep'
		on:click={() => voted('keep')}
	>
		<div class='emoji'>
			&#128077;
		</div>
		{yesString}
	</button>
	<button
		class='dismiss'
		on:click={() => voted('dismiss')}
	>
		<div class='emoji'>
			&#10060;
		</div>
		{noString}
	</button>
	<button
		class='skip'
		on:click={() => voted('skip')}
	>
		<div class='emoji'>
			&#129335;
		</div>
		{skipString}
	</button>
</div>

<style>
	.controls {
		align-items: center;
		display: grid;
		grid-auto-flow: column;
		justify-items: center;
	}

	.controls.vertical {
		grid-auto-flow: row;
		row-gap: 1em;
	}

	.controls button {
		cursor: pointer;
		font-size: 1em;
		padding: 0.5em;
		width: 6em;
	}

	.keep {
		background: rgb(219, 255, 164);
		border: 2px solid green;
	}
	.dismiss {
		background: rgb(255, 168, 168);
		border: 2px solid red;
	}
	.skip {
		background: lightyellow;
		border: 2px solid yellow;
	}
	.emoji {
		font-size: 2em;
	}
</style>
