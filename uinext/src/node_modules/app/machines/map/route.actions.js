import rison from 'rison';
import {assign} from 'xstate/lib/actions';
import {defaults} from 'app/stores/selection';

const getQuery = () => {
	const urlParams = new URL(document.location.toString()).searchParams;
	const params = _.fromPairs(Array.from(urlParams.entries()));
	const query = params.q && rison.decode(params.q);
	return query;
};

export default {
	mergeDefaultsAndParams: assign({
		parameters: {
			...defaults,
			...getQuery()
		}
	})
}
