import {get, writable} from 'svelte/store';
import {getNextOrg} from 'app/utils/eval';
import {_deviceId} from 'app/stores/device';
import {getDeviceId} from 'app/utils/device';

export const _currentOrg = writable();

export const loadNextOrg = async () => {
	let deviceId = get(_deviceId);
	if (!deviceId) {
		deviceId = await getDeviceId();
		_deviceId.set(deviceId);
	}
	const result = await getNextOrg(deviceId);
	_currentOrg.set(result.org);
};
